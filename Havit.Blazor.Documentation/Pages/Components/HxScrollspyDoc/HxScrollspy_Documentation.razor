@page "/components/HxScrollspy"

<ComponentApiDoc Type="typeof(HxScrollspy)">

    <DocHeading Title="How it works" />
    <p>
        Scrollspy needs two components to work together. The <code>HxScrollspy</code> component wraps
        the area to spy on, and the <a href="/components/@nameof(HxNav)"><code>@nameof(HxNav)</code></a> or a list-group (with <code><a href="/components/@nameof(HxScrollspyNavLink)">@nameof(HxScrollspyNavLink)</a>s</code>) represent the navigation.
        These components need to be associated using the <code>HxScrollspy.TargetId</code> parameter.
        For more details, see the <a href="https://getbootstrap.com/docs/5.3/components/scrollspy/">Bootstrap documentation</a>.
    </p>

    <p>The scrollspy navigation has to use a custom <code>HxScrollspyNavLink</code> to work around the <code>&lt;base&gt;</code> Blazor requirement and the inability of Bootstrap to interpret the <code>page#fragment</code> form of link.</p>

    <p>For anchor-fragment navigation (<code>&lt;a href="#id"&gt;</code>) to work in <code>net7.0</code> and earlier, the page has to host the <a href="/components/HxAnchorFragmentNavigation">HxAnchorFragmentNavigation</a> component.</p>

    <DocAlert Type="DocAlertType.Warning">
        The current component design expects the scrollspy to be used in a <b>dedicated scrollable container</b>
        (such as <code>&lt;div&gt;</code> or <a href="/components/HxOffcanvas">HxOffcanvas</a>).<br />
        For full-page scrollspy, the spying has to be attached directly to <code>&lt;body&gt;</code> (will be implemented later as needed?).
    </DocAlert>

    <DocHeading Title="Static content with HxNav navigation" />
    <Demo Type="typeof(HxScrollspy_Demo_HxNav)" />

    <DocHeading Title="Static content with list-group navigation" />
    <Demo Type="typeof(HxScrollspy_Demo_ListGroup)" />

    <DocHeading Title="Dynamic content (async loaded data)" />
    <DocAlert Type="DocAlertType.Warning">
        <p>
            Bootstrap scrollspy calculates offsets of individual sections when activated (i.e. <code>OnAfterRenderAsync</code> within first render). If the content changes dynamically,
            you have to refresh the offsets manually by calling <code>HxScrollspy.RefreshAsync()</code>.
        </p>
        <p>
            A similar issue applies for fragment-navigation. You have to postpone the initial fragment navigation to happen after the data gets loaded and the UI renders the final version
            (by setting <code>&lt;HxAnchorFragmentNavigation Automation="HxAnchorFragmentNavigation.SamePage"&gt;</code>
            and calling <code>HxAnchorFragmentNavigation.ScrollToCurrentUriFragmentAsync()</code>).
        </p>
        <p>Consider using <i>placeholders</i> to fix the UI layout while loading.</p>
    </DocAlert>
    <Demo Type="typeof(HxScrollspy_Demo_DynamicContent)" />

    <DocHeading Title="Custom navigation content" />
    <DocAlert>
        When using <code>HxButton</code> inside <code>HxScrollspyNavLink</code>, be sure to set <code>OnClickStopPropagation = "true"</code>.
        If you don't, the application will navigate to <code>/#anchor</code> of the <code>HxScrollspyNavLink</code> after the <code>OnClick</code> handler completes.
    </DocAlert>
    <Demo Type="typeof(HxScrollspy_Demo_CustomNavigationContent)" />
</ComponentApiDoc>

<ComponentApiDoc Type="typeof(HxScrollspyNavLink)" />
